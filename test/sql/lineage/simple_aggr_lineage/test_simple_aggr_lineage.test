# name: test/sql/lineage/simple_aggr_lineage/test_simple_aggr_lineage.test
# description: Test Simple Aggregate Lineage
# group: [simple_aggr_lineage]


statement ok
PRAGMA explain_output = PHYSICAL_ONLY;

statement ok
CREATE TABLE t1(i INTEGER);

statement ok
INSERT INTO t1 SELECT i FROM range(0,5) tbl(i);

statement ok
PRAGMA trace_lineage = "ON";

query I
select COUNT(*) from t1
----
5

statement ok
PRAGMA trace_lineage = "OFF";

query II
SELECT * FROM queries_list;
----
9	select COUNT(*) from t1
11	PRAGMA trace_lineage = "OFF";


query IIII
select rowid, chunk_id, range_start, range_end from SEQ_SCAN_9_0_range;
----
0	0	0	5
1	0	0	5

query IIII
select rowid, chunk_id, value, index from SEQ_SCAN_9_0_filter;
----