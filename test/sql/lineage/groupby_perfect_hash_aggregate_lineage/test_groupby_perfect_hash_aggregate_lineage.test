# name: test/sql/lineage/groupby_lineage/test_groupby_perfect_hash_aggregate_lineage.test
# description: Test Group By linage -- hash aggregate
# group: [groupby_perfect_hash_aggregate_lineage]

statement ok
CREATE TABLE t1(i INTEGER, j INTEGER);

statement ok
INSERT INTO t1 VALUES (1, 2),  (5, 2), (1, 4), (2, 1), (1, 3),(2, 2), (4, 1), (5, 1)

# standalone limit
query II
select t1.i, avg(t1.j) from t1 GROUP BY t1.i
----
1	3.000000
2	1.500000
4	1.000000
5	1.500000


query IIII
select rowid, chunk_id, index, value from PERFECT_HASH_GROUP_BY_OUT;
----
0	0	0	1
1	0	1	2
2	0	2	4
3	0	3	5


query IIII
select rowid, chunk_id, index, value from PERFECT_HASH_GROUP_BY_SINK;
----
0	0	0	1
1	0	1	5
2	0	2	1
3	0	3	2
4	0	4	1
5	0	5	2
6	0	6	4
7	0	7	5